4강- 조건부 확률 (Conditional Probability)

이번 강의의 큰 주제는 조건부 확률과 독립.

** 몽모르트 문제 복습
문제 : 카드중 j번째 카드에 j숫자가 나올 확률을 구하는 문제.
이 문제를 inclusion-exclusion 방법으로 쉽게 풀 수 있었던 이유는 대칭성 때문.

P(A1 n A2 n A3 ... Ak) = (n-k)! / n!
다음과 같은 답이 나오는 이유는, 첫번째에는 1이 나오고, 두번째에는 2가 나오고... 나머지
n-k 수에는 아무 카드나 와도 상관 없으므로 다음과 같은 식이 유도됨.

따라서 앞선 식은 생략하고
P(U Aj) = 1- 1/2! + 1/3! - .... + (-1)^(n+1) / n! 로 나타낼 수 있음.

이 식을 조금 변형하면, 전부 짝이 맞지 않을 확률로도 나타낼 수 있는데,
1을 빼면 된다.

따라서 테일러 급수에 의해서 1/e 라는 값이 나오게 됨.
사람들을 갑자기 확률에서 e라는 값이 나와 놀라기도 하는데,
그 이유는 카드를 섞어 확률을 계산하는데 갑자기 미적분이나 저~기 다른데서 나올만한 e가 나오기 때문.

위의 식과 같은 (-1)^(n+1) / n! 를 무한대로 가면 어떻게 될까?
직관적으로 생각하면 카드의 개수가 많아지므로 j번째 카드에 j가 올 확률은 카드 개수가 늘어나는 만큼
확률을 낮아지지만, 맞출 수 있는 더 많은 기회가 생긴다.

즉, 이러한 두 개의 확률의 접점(?) 이 1/e가 되는 것임.
이 수업에서 1/e라는 수를 자주 보게 될 것임.

** 독립
식은 간단하지만 정의 자체를 이해하는 것은 어려울 수 있음.
Defn : Events A,B and independent if P(AnB) = P(A) * P(B)
-> 표본 공간이 있고 다룰 확률 함수 P가 있다고 할 때, 앞선 2가지 가정을 만족해야함.

* 간혹 배반(disjoint)과 혼동하는 경우가 있는데, 조심해야함.
A와 B가 배반이라고 하면, A가 일어났다면 B는 일어날 수 없다는 것임.
독립은 A가 일어날 때, B가 일어날지에 대해 아무런 이야기를 못 한다는 이야기.

* A, B, C 가 독립인 경우.
먼저 각 쌍들이 독립이여야 함.(교집합 기호를 comma로 사용해도 됨)
-> 직관적으로 생각해도 일단 이걸 만족해야 겠지? 
그렇다면 다음과 같은 식을 만족하겠지.

P(A, B) = P(A)P(B)
P(A, C) = P(A)P(C)
P(B, C) = P(B)P(C)

생각해보자. 이 세가지 식만 만족하면 되는 것일까?
No 하나 더 필요
P(A, B, C) = P(A)P(B)P(C) 이 식이 필요하다.

그렇다면 위의 세개의 식을 만족하면 해당 식도 만족하는 것일까?
정답은 "보통은 그렇지 않다"이다.

결과적으로 4개의 식은 특정 식이 다른 식을 포함한다고 할 수도 없고, 
4개의 식을 모두 만족해야한다는 것이다.

유사하게, A1, A2, .. An개의 사건에 대해서 독립이라면,
교사건을 구할때 곱하는 것을 의미.

나중에는 다른 관점으로도 독립을 표현해 보자.

** Newton-Pepys Problem(1693)
새뮤얼 피프스는 유명한 일기 작가.
각 면이 1부터 6까지 있고 나올 확률이 모두 같음. 
다음 세 가지 가능성 중에 뭐가 제일 높을까?

첫 번째 사건 : 6개의 주사위 중 적어도 하나의 주사위가 6이 나올 사건.   <- Newton
두 번째 사건 : 12개의 주사위로 적어도 2개의 6이 나올 사건. 
세 번째 사건 : 18개의 주사위로 적어도 3개의 6이 나올 사건.                <- Pepys

증명해 보면 다음과 같다.
P(첫번째 사건) : 1 - (5/6)^6  =0.66
P(두번째 사건) : 1 - ((5/6) ^ 12 + (5/6) ^(11) * (1/6) * 12) = 0.61
P(세번째 사건) : 1 - sigma k=0 ~ 2 18 C k (1/6)^k (5/6) ^(18-k) =  0.59

따라서 A가 일어날 확률이 제일 높다.

** 조건부 확률(Conditional probability)
통계는 불확실성에 대한 학문.
대부분의 일상적인 일들은  완벽한 100% 는 없음. 항상 불확실성이 존재.

믿음을 어떻게 갱신하는가?
how should you update prob / 
새로운 정보가 들어오면, 이를 어떻게 업데이트 할 것인가?
-> 우리는 통계적으로, 수학적으로 갱신해야 할 것이다.

"Conditioning is the soul of statistics."

Defn
P(A|B) : B라는 사건이 일어났을때, A의 사건이 일어날 확률. (다음과 같이 |로 표시)
          만약 A와 B가 독립적이라면, 해당 정보는 의미가 없음. -> B가 일어났을 때, A가 일어날 확률과 단순히 A가 일어날 확률이 같기 떄문.
          but 독립이 아니라면 가치있는 정보가 될 것이다.

P(A|B) = P(A n B) / P(B) , if P(B) > 0

다양한 정리를 보게 될 것인데, 이는 엄청 간단해 보이지만
정말 다양한 예제에서 사용되게 될 것임!
-> 왜 이게 유용한 개념인지 알게 될 것이다.


이 정의에 직관을 2가지 방법으로 부여해 보겠음.
P(A | B)를 볼 때 그냥 정의를 바로 이용할 수도 있겠지만, 이 정의가 저희가 조건을 붙일 때, 
합리적인 방식이라고 생각하는 방식이라고 느끼면 좋겠지용?  

*직관1
조약돌 세계(Pebble world) 
표본공간 S.
 ---------
| o1  o2  o3 |
| o4  o5  o6 |
| o7  o8  o9 | 
 ---------

먼저 표본공간 S를 그린다. 우리가 통상적으로 쓰는 확률의 단순한 정의를 넘어서 생각해보자.
유한개의 가능한 결과가 있는데, 이는 각각 다른 확률로 표현될 수 있다.
각각은 조약돌로 표현된다. 9개를 그리는데, 9개의 조약돌이고 이 조약돌들의 제한 조건은 
전체 질량의 합이 1이라는 것. 

확률과 사건과 부분집합 사이의 관련성을 배웠는데,
사건은 부분집합일 뿐이다. 

예를들어, 1,2,4,5번 돌을 묶은 공간(space)가 사건 B라고 해보자.
사건 B는 조약돌의 집합이고 P(A | B)를 구하고 싶다고 해보자.
이게 의미하는 것은 B가 이미 일어났다고 해석하면 됨. 즉, B 공간 안에 조약돌이 선택되었다고 가정하므로,
그러므로 B 밖에 있는 5개는 관련이 없게 됨.
이제 네 개의 조약돌만 남음! 쉽게 말하면 원래 S라고 하는 우주가 있었는데,
B라고 하는 공간을 우리의 우주로 한정시킨 것임.

그냥 평소에 하던대로 확률의 법칙을 적용하면 됨.
따라서 A의 사건이 조약돌 5,6,8,9가 선택될 확률 이라고하면 
결과적으로 5번 조약돌이 선택될 확률이라는 것! --> P(A n B)

이 때, 우리는 공간을 B의 사건을 우리의 우주, 공간으로 한정시켰기 때문에,
이 B 사건이 일어날 확률의 공간을 1로 맞추어 주어야 한다. --> 재정규화(renormalization)
따라서 P(B)로 나눠 주는 것.

P(A|B) = 1. get rid if pebble B^C
            2. renormalize space

* 직관2
빈도학파 세계(frequentist world)

실험을 여러번 반복.
철학적인 문제가 있지만 정확히 같은 실험을 여러 번 반복할 수 있다고 하자.
확률을 보는 하나의 관점이 장기간의 빈도.
예를들어 동전을 1000번 던졌을 때, 앞면이 512번이 나온다면
확률을 512 / 1000 으로 보겠다는 의미!(나에겐 굉장히 친근..)

이제 우리가 해야할 일은 각 시행에 대한 리스트를 만드는 것.
쉬운 예제로 유한한 이진 데이터를 만들어 낸다고 생각해보자.

10110101011
10101110011
10100101011
101110101010
      ... 

이 중 B의 사건을 선택하면,    뭐 십만개 중에 100개 정도가 있다고 하고, 
그 중에 A의 사건을 선택하면, B 중에 A가 있을 것이다~ -> P(A n B)
똑같이 renormalization 을 하면 조건부 확률 완성

** 간단한 정리들 보기(조건부 확률 응용)
정리1
P(A n B)  = P(B)P(A|B) = P(A)P(B|A)
이때 독립이라면, P(A n B) = P(A)P(B) 인데, P(B)P(A|B) 라는 식에서
P(A|B)는 P(A)로 바뀐다는 것!

정리2
P(A1, A2, A3 .... , An) = P(A1) * P(A2|A1) * P(A3|A1,A2) * P(P4|A1, A2, A3) ... 
[ n! them...] -> 우변을 계산해보면 n! 개가 나온다는 것^^
-> 패턴이 보임. 

정리3(Bayes' Rule) : 베이즈는 목사이자 통계를 연구하던 사람.
P( A | B) 와 P(B | A) 라는 식을 연결 짓고 싶다. 
위의 식에서 P(B)P(A|B) = P(A)P(B|A) 를 응용해보자.
양변을 P(B) 로 나누어보면,
P(A|B) = P(B|A) * P(A) / P(B) ( 끝)

실제로 식은 쉽게 유도되지만, 이게 함축하는 내용은 정말 깊음.






























